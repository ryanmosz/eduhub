# Developer Onboarding Cheat-Sheet

Welcome to the EduHub modernization sprint!
This page distills the **must-know** facts for working productively in this repo.

## 1. Repository Layout (High-Level)

| Path | Purpose |
|------|---------|
| `src/` | Application code (namespaced packages live here). |
| `tests/` | Pytest suites (mirrors structure under `src/`). |
| `docs/` | Project documentation (plans, design notes, this guide). |
| `tasks/` | PRDs & task lists generated by the AI workflow. |
| `upstream/` | Checked-in Plone buildout & CMFPlone sources. |
| `Dockerfile`, `docker-compose.yml` | Container build & multi-service dev stack. |
| `.github/workflows/` | CI pipelines (lint, test, build, deploy). |

## 2. Python Versions & Virtual Envs

* Supported: **3.9** (legacy) & **3.11** (target).
* Create a local venv:

```bash
python3.11 -m venv .venv
source .venv/bin/activate
pip install -r requirements-dev.txt
```

* Use **`tox`** to test against both versions:

```bash
tox                # runs all envs
tox -e py311       # single env
```

## 3. Docker & Compose

Local full-stack:

```bash
docker compose up -d   # Plone, Postgres, Redis, FastAPI, etc.
```

*The first build can take a while—grab a coffee ☕️.*

Common commands:

| Action | Command |
|--------|---------|
| rebuild images | `docker compose build` |
| view logs | `docker compose logs -f [service]` |
| stop stack | `docker compose down` |

## 4. Running Tests

```bash
pytest -q                # fast feedback
pytest -q tests/hello.py # single file
```

* Async tests use **pytest-asyncio**; mark with `@pytest.mark.asyncio`.

Coverage & benchmarks run automatically in CI.

## 5. Code Quality Gates

Tool | Invocation | CI Gate
-----|------------|--------
Black | `black .` | must pass
Isort | `isort .` | must pass
Mypy | `mypy src/` | warnings fail CI
Flake8 (via Ruff soon) | `flake8` | advisory
Pre-commit | `pre-commit run -a` | auto-fix hooks

Tip: install the git hook once:

```bash
pre-commit install
```

## 6. Commit & Branch Strategy

* **Conventional Commits** (`feat:`, `fix:`, `docs:`, `chore:` …).
* Feature branches from `main`, PR via GitHub.

Example:

```
feat(api): add /hello endpoint

Adds async FastAPI route /hello returning JSON {"msg":"Hello World"}.
Updates tests and OpenAPI docs.
```

## 7. AI-Assisted Workflow

We use **Cursor rules** under `.cursor/rules/`:

1. Write a PRD in `/tasks/prd-*.md` (prompt the AI, answer clarifying questions).
2. Generate high-level tasks (`tasks/tasks-*.md`).
3. Respond "Go" to explode into sub-tasks.
4. Implement code; AI can draft patches via XML diff protocol.

**Never** bypass the XML format when asking the assistant to change files—CI will reject the PR.

## 8. Environment Variables

1. Duplicate `.env.example` → `.env`.
2. Fill in secrets (DB passwords, OAuth keys).
   *Never commit real secrets.*
3. Docker Compose automatically loads `.env`.

## 9. Continuous Integration (GitHub Actions)

Matrix: `python-version: [3.9, 3.11]`

Jobs:

1. **lint** – black, isort, mypy
2. **test** – pytest with coverage
3. **build** – Docker image, push if on `main`
4. **deploy** (future) – Helm upgrade to staging

CI must be green before merge.

## 10. Useful Make Targets (coming soon)

```make
make dev     # build & start compose stack
make fmt     # black + isort
make lint    # static checks
make clean   # remove __pycache__, build artifacts
```

---

Happy hacking!
Questions? Open an issue or ping in the #eduhub-dev Slack channel.